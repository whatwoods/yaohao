<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公寓摇号系统</title>
    <meta name="description" content="公寓房间随机分配摇号系统">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E🎲%3C/text%3E%3C/svg%3E">
</head>

<body>
    <div class="app-container">
        <!-- 上传区域 -->
        <div id="upload-section" class="upload-section">
            <div class="upload-card glass-card">
                <div class="upload-icon">📁</div>
                <h1>公寓摇号系统</h1>
                <p class="upload-hint">上传包含员工信息的 Excel 文件开始摇号</p>
                <div id="drop-zone" class="drop-zone">
                    <input type="file" id="file-input" accept=".xlsx,.xls" hidden>
                    <div class="drop-zone-content">
                        <span class="drop-icon">⬆️</span>
                        <p>拖拽文件到此处，或</p>
                        <button id="browse-btn" class="btn btn-primary">选择文件</button>
                    </div>
                </div>
                <p class="file-format-hint">支持 .xlsx, .xls 格式</p>
            </div>
        </div>

        <!-- 数据展示和摇号区域 -->
        <div id="lottery-section" class="lottery-section hidden">
            <div class="lottery-header glass-card">
                <h2>🏠 摇号分配</h2>
                <div class="btn-group">
                    <button id="home-btn" class="btn btn-secondary hidden">🏠 返回首页</button>
                    <button id="export-excel-btn" class="btn btn-secondary hidden">📊 导出Excel</button>
                    <button id="export-pdf-btn" class="btn btn-secondary hidden">📄 导出PDF</button>
                    <button id="lottery-btn" class="btn btn-success">🎲 开始摇号</button>
                </div>
            </div>

            <div class="table-container glass-card">
                <table id="data-table">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>工号</th>
                            <th>性别</th>
                            <th>房间号</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- 动态生成 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 撒花画布 -->
    <canvas id="confetti-canvas"></canvas>

    <!-- 依赖库 -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- 应用脚本 -->
    <script src="js/excel.js"></script>
    <script src="js/lottery.js"></script>
    <script src="js/app.js"></script>
</body>

</html>